#!/bin/sh

echo "This command will do the follwing:"
echo "git add ~/.dotfiles/"
echo "git commit -m your_message"
echo "git push -u origin main"
echo ""
echo "As well as adding other useful file such as 'dnf history' and so on"
echo ""
echo "Are you sure you want to proceed? [y\n]"
read opt

write_stuff() {
  # first clean the folder
  rm -rf ~/.dotfiles/misc_txt_files/*
  
  # list installed and removed programs etc
  dnf history | grep -E 'install|\bremove\b' >> installed_programs_fedora.txt
  # list installed extension vscode
  code --list-extensions >> installed_vscode_extensions.txt
}

if [ $opt == "y" ]; then
  echo "Wiping ~/.dotfiles/misc_txt_files and writing stuff"
  write_stuff
  echo "Write a message for your commit"
  read message 
  echo "Proceeding..."
  git add ~/.dotfiles/ 
  git commit -m "${message}"
  git push -u origin main 
else 
  echo Aborting...
fi
